<div class="max-w-full mx-auto p-2 bg-gray-50 min-h-screen">
  <h1 class="text-lg font-bold mb-3 text-gray-800">病院登録</h1>

  <%= form_with model: @hospital, url: hospital_index_path, local: true do |f| %>
    <!-- 病院情報セクション -->
    <div class="bg-white rounded-lg shadow-sm p-3 mb-3">
      <div class="mb-2">
        <%= f.label :name, "病院名", class: "block text-xs font-semibold text-gray-700 mb-1" %>
        <%= f.text_field :name, class: "w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500" %>
      </div>

      <div class="mb-2">
        <%= f.label :description, "メモ", class: "block text-xs font-semibold text-gray-700 mb-1" %>
        <%= f.text_area :description, rows: 2, class: "w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500" %>
      </div>
    </div>

    <!-- 診療時間セクション -->
    <div class="bg-white rounded-lg shadow-sm p-2">
      <h2 class="text-base font-bold mb-2 text-gray-800">診療時間</h2>

     <!-- テーブルヘッダー -->
      <div class="w-full">
        <!-- ヘッダー行 -->
        <div class="grid grid-cols-5 gap-0.5 mb-1">
          <div class="col-span-2 text-center">
            <div class="text-[10px] font-semibold text-gray-700 bg-blue-50 rounded py-1">
              午前の診療時間
            </div>
          </div>
          <div class="col-span-2 text-center">
            <div class="text-[10px] font-semibold text-gray-700 bg-green-50 rounded py-1">
              午後の診療時間
            </div>
          </div>
        </div>

  <div class="space-y-1">
    <%
      schedules_by_day = @hospital.hospital_schedules.group_by(&:day_of_week)

      schedules_by_day.each do |day_of_week, schedules|
        morning = schedules.find { |s| s.period == "morning" }
        afternoon = schedules.find { |s| s.period == "afternoon" }
    %>

      <!-- 1行 -->
      <div class="grid grid-cols-[10px_1fr_16px_1fr_1fr_16px_1fr] gap-1 items-center">

        <!-- 曜日 -->
        <div class="text-xs">
          <%= HospitalSchedule.day_of_weeks_i18n[day_of_week.to_sym] %>
        </div>

        <!-- 午前 開始 -->
        <%= f.fields_for :hospital_schedules, morning do |sf| %>
          <%= sf.hidden_field :day_of_week %>
          <%= sf.hidden_field :period %>

          <%= time_select_15min(sf, :start_time, 8, 12) %>
        <% end %>

        <!-- 〜 -->
        <div class="text-center text-gray-500 text-xs">〜</div>

        <!-- 午前 終了 -->
        <%= f.fields_for :hospital_schedules, morning do |sf| %>
          <%= time_select_15min(sf, :end_time, 8, 12) %>
        <% end %>



        <!-- 午後 開始 -->
        <%= f.fields_for :hospital_schedules, afternoon do |sf| %>
          <%= sf.hidden_field :day_of_week %>
          <%= sf.hidden_field :period %>

          <%= time_select_15min(sf, :start_time, 13, 18) %>
        <% end %>

        <!-- 〜 -->
        <div class="text-center text-gray-500 text-xs">〜</div>

        <!-- 午後 終了 -->
        <%= f.fields_for :hospital_schedules, afternoon do |sf| %>
          <%= time_select_15min(sf, :end_time, 13, 18) %>
        <% end %>
      </div>
    <% end %>
  </div>
    </div>

    <!-- 送信ボタン -->
    <div class="mt-3">
      <%= f.submit "登録", class: "btn btn-primary" %>
    </div>
  <% end %>
</div>
